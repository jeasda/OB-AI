<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qwen Image Edit | OB AI Studio</title>
  <link rel="icon" type="image/png" href="/logo.png">
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <div class="page">
    <header class="header">
      <div class="brand">
        <img src="/logo.png" alt="OB AI Studio" class="brand-logo">
        <div>
          <div class="brand-title">OB AI Studio</div>
          <div class="brand-subtitle">Qwen Image Edit</div>
        </div>
      </div>
      <div class="header-actions">
        <div id="state-pill" class="pill"></div>
        <div id="credit-pill" class="pill"></div>
        <button class="icon-btn">เข้าสู่ระบบ</button>
      </div>
    </header>

    <main class="layout">
      <aside class="panel panel-section">
        <div>
          <div class="panel-title">ตั้งค่า</div>
          <h2>อัปโหลดภาพ</h2>
          <p class="muted">รองรับ JPG/PNG ขนาดไม่เกิน 10MB</p>
        </div>

        <div id="upload-zone" class="upload-zone">
          <div>ลากภาพมาวาง หรือกดเพื่อเลือกไฟล์</div>
          <div class="muted">ระบบจะปรับภาพด้วย Qwen</div>
          <input id="file-input" type="file" accept="image/png,image/jpeg" hidden>
          <img id="preview-thumb" alt="preview" class="upload-thumb hidden">
        </div>

        <div class="panel-section">
          <div class="panel-title">ตัวเลือก</div>
          <div class="panel">
            <strong>ขั้นที่ 2: เลือกพื้นที่</strong>
            <div class="muted">ตอนนี้ระบบใช้ทั้งภาพ ไม่ต้องวาดมาสก์</div>
          </div>
          <div id="options-slot" class="panel-section"></div>
        </div>

        <div class="panel-section">
          <label class="field-label" for="prompt-input">เขียนสิ่งที่อยากแก้ไข</label>
          <textarea id="prompt-input" class="prompt-input" rows="3" placeholder="เช่น เปลี่ยนชุดเป็นชุดไปเที่ยว แสงอุ่นๆ"></textarea>
        </div>

        <div id="ratio-slot" class="panel-section"></div>

        <details id="prompt-preview" class="panel">
          <summary>Prompt ที่จะใช้</summary>
          <div class="muted" style="margin-top: 8px;">
            <div id="prompt-preview-text"></div>
            <div id="prompt-preview-tags" style="margin-top: 8px;"></div>
          </div>
        </details>

        <div class="panel-section">
          <button id="submit-btn" class="btn btn-primary">เริ่มแก้ไขภาพ</button>
          <div id="inline-error" class="muted" style="color:#b91c1c;"></div>
          <div class="muted">โหมดทดสอบ: ระบบชำระเงินจำลองและยังไม่ตัดเงินจริง</div>
        </div>
      </aside>

      <section class="panel-section">
        <div id="marketing-panel" class="preview-card">
          <div class="panel-title">Qwen Image Edit</div>
          <h1>แก้ไขภาพให้เป็นสไตล์ใหม่แบบสมจริง</h1>
          <p class="muted">เลือกชุด โลเคชัน อารมณ์ และท่าทาง แล้วให้ Qwen จัดการให้จบในไม่กี่ขั้นตอน</p>
          <div class="panel-section" style="gap: 12px;">
            <div class="panel">
              <strong>1. อัปโหลดภาพ</strong>
              <div class="muted">ภาพหน้าชัด แสงดี จะได้ผลลัพธ์สวยขึ้น</div>
            </div>
            <div class="panel">
              <strong>2. เลือกตัวเลือก</strong>
              <div class="muted">กำหนดชุด ฉาก และอารมณ์ที่ต้องการ</div>
            </div>
            <div class="panel">
              <strong>3. เริ่มแก้ไข</strong>
              <div class="muted">รอไม่กี่นาที ระบบจะเตรียมภาพให้</div>
            </div>
          </div>
        </div>

        <div id="before-after" class="panel hidden">
          <div class="panel-title">ภาพต้นฉบับ</div>
          <div class="mask-stage">
            <img id="before-image" alt="before" class="upload-thumb">
            <canvas id="mask-canvas" class="mask-canvas"></canvas>
            <div id="mask-hint" class="mask-hint">ระบายส่วนที่ต้องการแก้ไข</div>
          </div>
        </div>

        <div id="progress-slot"></div>
        <div id="result-slot"></div>

        <div id="error-panel" class="error-box hidden">
          <div id="error-text"></div>
          <button id="retry-btn" class="btn btn-secondary" style="margin-top: 12px;">ลองอีกครั้ง</button>
        </div>
      </section>

      <aside class="panel panel-section">
        <div class="panel-title">ผลลัพธ์</div>
        <button id="download-btn" class="btn btn-secondary">ดาวน์โหลด HD (ใช้ 1 เครดิต)</button>
        <button id="generate-new-btn" class="btn btn-secondary">เจนใหม่</button>
        <div id="credit-rail" class="muted"></div>
      </aside>
    </main>
  </div>

  <div id="payment-modal-root"></div>

  <script type="module" src="./app.js"></script>
</body>
</html>
